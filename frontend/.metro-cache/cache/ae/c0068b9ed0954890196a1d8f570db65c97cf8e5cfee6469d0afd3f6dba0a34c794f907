{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":91,"index":91}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":133},"end":{"line":3,"column":69,"index":202}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"../utils/api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":203},"end":{"line":4,"column":48,"index":251}}],"key":"XoJ+jbKCrEi38eKczMqtlbk+TCk=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/src/context/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"useAuth\", {\n    enumerable: true,\n    get: function () {\n      return useAuth;\n    }\n  });\n  exports.AuthProvider = AuthProvider;\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeWebDistExportsPlatform = require(_dependencyMap[1], \"react-native-web/dist/exports/Platform\");\n  var Platform = _interopDefault(_reactNativeWebDistExportsPlatform);\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[2], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _utilsApi = require(_dependencyMap[3], \"../utils/api\");\n  var _reactJsxDevRuntime = require(_dependencyMap[4], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)({});\n  const useAuth = () => (0, _react.useContext)(AuthContext);\n  function AuthProvider({\n    children\n  }) {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [token, setToken] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const storeToken = async t => {\n      await AsyncStorage.default.setItem('auth_token', t);\n      setToken(t);\n      _utilsApi.api.setToken(t);\n    };\n    const clearToken = async () => {\n      await AsyncStorage.default.removeItem('auth_token');\n      setToken(null);\n      _utilsApi.api.setToken(null);\n    };\n    const checkAuth = (0, _react.useCallback)(async () => {\n      try {\n        // CRITICAL: If returning from OAuth callback, skip check\n        if (Platform.default.OS === 'web' && false) {\n          if (window.location.hash?.includes('session_id=')) {\n            setIsLoading(false);\n            return;\n          }\n        }\n        const storedToken = await AsyncStorage.default.getItem('auth_token');\n        if (storedToken) {\n          _utilsApi.api.setToken(storedToken);\n          const userData = await _utilsApi.api.get('/auth/me');\n          setUser(userData);\n          setToken(storedToken);\n        }\n      } catch {\n        await clearToken();\n      } finally {\n        setIsLoading(false);\n      }\n    }, []);\n    (0, _react.useEffect)(() => {\n      checkAuth();\n    }, [checkAuth]);\n    const login = async (email, password) => {\n      const data = await _utilsApi.api.post('/auth/login', {\n        email,\n        password\n      });\n      await storeToken(data.token);\n      setUser(data.user);\n    };\n    const register = async (name, email, password) => {\n      const data = await _utilsApi.api.post('/auth/register', {\n        email,\n        password,\n        name\n      });\n      await storeToken(data.token);\n      setUser(data.user);\n    };\n\n    // REMINDER: DO NOT HARDCODE THE URL, OR ADD ANY FALLBACKS OR REDIRECT URLS, THIS BREAKS THE AUTH\n    const loginWithGoogle = () => {\n      if (Platform.default.OS === 'web' && false) {\n        const redirectUrl = window.location.origin + '/(tabs)/dashboard';\n        window.location.href = `https://auth.emergentagent.com/?redirect=${encodeURIComponent(redirectUrl)}`;\n      }\n    };\n    const handleGoogleCallback = async sessionId => {\n      const data = await _utilsApi.api.post('/auth/google-session', {\n        session_id: sessionId\n      });\n      await storeToken(data.token);\n      setUser(data.user);\n    };\n    const logout = async () => {\n      try {\n        await _utilsApi.api.post('/auth/logout');\n      } catch {/* ignore */}\n      await clearToken();\n      setUser(null);\n    };\n    const updateUser = u => setUser(u);\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        token,\n        isLoading,\n        login,\n        register,\n        loginWithGoogle,\n        handleGoogleCallback,\n        logout,\n        updateUser\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 5\n    }, this);\n  }\n});","lineCount":129,"map":[[13,2,29,0,"Object"],[13,8,29,0],[13,9,29,0,"defineProperty"],[13,23,29,0],[13,24,29,0,"exports"],[13,31,29,0],[14,4,29,0,"enumerable"],[14,14,29,0],[15,4,29,0,"get"],[15,7,29,0],[15,18,29,0,"get"],[15,19,29,0],[16,6,29,0],[16,13,29,0,"useAuth"],[16,20,29,0],[17,4,29,0],[18,2,29,0],[19,2,31,0,"exports"],[19,9,31,0],[19,10,31,0,"AuthProvider"],[19,22,31,0],[19,25,31,0,"AuthProvider"],[19,37,31,0],[20,2,1,0],[20,6,1,0,"_react"],[20,12,1,0],[20,15,1,0,"require"],[20,22,1,0],[20,23,1,0,"_dependencyMap"],[20,37,1,0],[21,2,1,91],[21,6,1,91,"_reactNativeWebDistExportsPlatform"],[21,40,1,91],[21,43,1,91,"require"],[21,50,1,91],[21,51,1,91,"_dependencyMap"],[21,65,1,91],[22,2,1,91],[22,6,1,91,"Platform"],[22,14,1,91],[22,17,1,91,"_interopDefault"],[22,32,1,91],[22,33,1,91,"_reactNativeWebDistExportsPlatform"],[22,67,1,91],[23,2,3,0],[23,6,3,0,"_reactNativeAsyncStorageAsyncStorage"],[23,42,3,0],[23,45,3,0,"require"],[23,52,3,0],[23,53,3,0,"_dependencyMap"],[23,67,3,0],[24,2,3,0],[24,6,3,0,"AsyncStorage"],[24,18,3,0],[24,21,3,0,"_interopDefault"],[24,36,3,0],[24,37,3,0,"_reactNativeAsyncStorageAsyncStorage"],[24,73,3,0],[25,2,4,0],[25,6,4,0,"_utilsApi"],[25,15,4,0],[25,18,4,0,"require"],[25,25,4,0],[25,26,4,0,"_dependencyMap"],[25,40,4,0],[26,2,4,48],[26,6,4,48,"_reactJsxDevRuntime"],[26,25,4,48],[26,28,4,48,"require"],[26,35,4,48],[26,36,4,48,"_dependencyMap"],[26,50,4,48],[27,2,28,0],[27,8,28,6,"AuthContext"],[27,19,28,17],[27,35,28,20],[27,39,28,20,"createContext"],[27,45,28,33],[27,46,28,33,"createContext"],[27,59,28,33],[27,61,28,51],[27,62,28,52],[27,63,28,72],[27,64,28,73],[28,2,29,7],[28,8,29,13,"useAuth"],[28,15,29,20],[28,18,29,23,"useAuth"],[28,19,29,23],[28,24,29,29],[28,28,29,29,"useContext"],[28,34,29,39],[28,35,29,39,"useContext"],[28,45,29,39],[28,47,29,40,"AuthContext"],[28,58,29,51],[28,59,29,52],[29,2,31,7],[29,11,31,16,"AuthProvider"],[29,23,31,28,"AuthProvider"],[29,24,31,29],[30,4,31,31,"children"],[31,2,31,71],[31,3,31,72],[31,5,31,74],[32,4,32,2],[32,10,32,8],[32,11,32,9,"user"],[32,15,32,13],[32,17,32,15,"setUser"],[32,24,32,22],[32,25,32,23],[32,28,32,26],[32,32,32,26,"useState"],[32,38,32,34],[32,39,32,34,"useState"],[32,47,32,34],[32,49,32,48],[32,53,32,52],[32,54,32,53],[33,4,33,2],[33,10,33,8],[33,11,33,9,"token"],[33,16,33,14],[33,18,33,16,"setToken"],[33,26,33,24],[33,27,33,25],[33,30,33,28],[33,34,33,28,"useState"],[33,40,33,36],[33,41,33,36,"useState"],[33,49,33,36],[33,51,33,52],[33,55,33,56],[33,56,33,57],[34,4,34,2],[34,10,34,8],[34,11,34,9,"isLoading"],[34,20,34,18],[34,22,34,20,"setIsLoading"],[34,34,34,32],[34,35,34,33],[34,38,34,36],[34,42,34,36,"useState"],[34,48,34,44],[34,49,34,44,"useState"],[34,57,34,44],[34,59,34,45],[34,63,34,49],[34,64,34,50],[35,4,36,2],[35,10,36,8,"storeToken"],[35,20,36,18],[35,23,36,21],[35,29,36,28,"t"],[35,30,36,37],[35,34,36,42],[36,6,37,4],[36,12,37,10,"AsyncStorage"],[36,24,37,22],[36,25,37,22,"default"],[36,32,37,22],[36,33,37,23,"setItem"],[36,40,37,30],[36,41,37,31],[36,53,37,43],[36,55,37,45,"t"],[36,56,37,46],[36,57,37,47],[37,6,38,4,"setToken"],[37,14,38,12],[37,15,38,13,"t"],[37,16,38,14],[37,17,38,15],[38,6,39,4,"api"],[38,15,39,7],[38,16,39,7,"api"],[38,19,39,7],[38,20,39,8,"setToken"],[38,28,39,16],[38,29,39,17,"t"],[38,30,39,18],[38,31,39,19],[39,4,40,2],[39,5,40,3],[40,4,42,2],[40,10,42,8,"clearToken"],[40,20,42,18],[40,23,42,21],[40,29,42,21,"clearToken"],[40,30,42,21],[40,35,42,33],[41,6,43,4],[41,12,43,10,"AsyncStorage"],[41,24,43,22],[41,25,43,22,"default"],[41,32,43,22],[41,33,43,23,"removeItem"],[41,43,43,33],[41,44,43,34],[41,56,43,46],[41,57,43,47],[42,6,44,4,"setToken"],[42,14,44,12],[42,15,44,13],[42,19,44,17],[42,20,44,18],[43,6,45,4,"api"],[43,15,45,7],[43,16,45,7,"api"],[43,19,45,7],[43,20,45,8,"setToken"],[43,28,45,16],[43,29,45,17],[43,33,45,21],[43,34,45,22],[44,4,46,2],[44,5,46,3],[45,4,48,2],[45,10,48,8,"checkAuth"],[45,19,48,17],[45,22,48,20],[45,26,48,20,"useCallback"],[45,32,48,31],[45,33,48,31,"useCallback"],[45,44,48,31],[45,46,48,32],[45,58,48,44],[46,6,49,4],[46,10,49,8],[47,8,50,6],[48,8,51,6],[48,12,51,10,"Platform"],[48,20,51,18],[48,21,51,18,"default"],[48,28,51,18],[48,29,51,19,"OS"],[48,31,51,21],[48,36,51,26],[48,41,51,31],[48,50,51,64],[48,52,51,66],[49,10,52,8],[49,14,52,12,"window"],[49,20,52,18],[49,21,52,19,"location"],[49,29,52,27],[49,30,52,28,"hash"],[49,34,52,32],[49,36,52,34,"includes"],[49,44,52,42],[49,45,52,43],[49,58,52,56],[49,59,52,57],[49,61,52,59],[50,12,53,10,"setIsLoading"],[50,24,53,22],[50,25,53,23],[50,30,53,28],[50,31,53,29],[51,12,54,10],[52,10,55,8],[53,8,56,6],[54,8,58,6],[54,14,58,12,"storedToken"],[54,25,58,23],[54,28,58,26],[54,34,58,32,"AsyncStorage"],[54,46,58,44],[54,47,58,44,"default"],[54,54,58,44],[54,55,58,45,"getItem"],[54,62,58,52],[54,63,58,53],[54,75,58,65],[54,76,58,66],[55,8,59,6],[55,12,59,10,"storedToken"],[55,23,59,21],[55,25,59,23],[56,10,60,8,"api"],[56,19,60,11],[56,20,60,11,"api"],[56,23,60,11],[56,24,60,12,"setToken"],[56,32,60,20],[56,33,60,21,"storedToken"],[56,44,60,32],[56,45,60,33],[57,10,61,8],[57,16,61,14,"userData"],[57,24,61,22],[57,27,61,25],[57,33,61,31,"api"],[57,42,61,34],[57,43,61,34,"api"],[57,46,61,34],[57,47,61,35,"get"],[57,50,61,38],[57,51,61,39],[57,61,61,49],[57,62,61,50],[58,10,62,8,"setUser"],[58,17,62,15],[58,18,62,16,"userData"],[58,26,62,24],[58,27,62,25],[59,10,63,8,"setToken"],[59,18,63,16],[59,19,63,17,"storedToken"],[59,30,63,28],[59,31,63,29],[60,8,64,6],[61,6,65,4],[61,7,65,5],[61,8,65,6],[61,14,65,12],[62,8,66,6],[62,14,66,12,"clearToken"],[62,24,66,22],[62,25,66,23],[62,26,66,24],[63,6,67,4],[63,7,67,5],[63,16,67,14],[64,8,68,6,"setIsLoading"],[64,20,68,18],[64,21,68,19],[64,26,68,24],[64,27,68,25],[65,6,69,4],[66,4,70,2],[66,5,70,3],[66,7,70,5],[66,9,70,7],[66,10,70,8],[67,4,72,2],[67,8,72,2,"useEffect"],[67,14,72,11],[67,15,72,11,"useEffect"],[67,24,72,11],[67,26,72,12],[67,32,72,18],[68,6,73,4,"checkAuth"],[68,15,73,13],[68,16,73,14],[68,17,73,15],[69,4,74,2],[69,5,74,3],[69,7,74,5],[69,8,74,6,"checkAuth"],[69,17,74,15],[69,18,74,16],[69,19,74,17],[70,4,76,2],[70,10,76,8,"login"],[70,15,76,13],[70,18,76,16],[70,24,76,16,"login"],[70,25,76,23,"email"],[70,30,76,36],[70,32,76,38,"password"],[70,40,76,54],[70,45,76,59],[71,6,77,4],[71,12,77,10,"data"],[71,16,77,14],[71,19,77,17],[71,25,77,23,"api"],[71,34,77,26],[71,35,77,26,"api"],[71,38,77,26],[71,39,77,27,"post"],[71,43,77,31],[71,44,77,32],[71,57,77,45],[71,59,77,47],[72,8,77,49,"email"],[72,13,77,54],[73,8,77,56,"password"],[74,6,77,65],[74,7,77,66],[74,8,77,67],[75,6,78,4],[75,12,78,10,"storeToken"],[75,22,78,20],[75,23,78,21,"data"],[75,27,78,25],[75,28,78,26,"token"],[75,33,78,31],[75,34,78,32],[76,6,79,4,"setUser"],[76,13,79,11],[76,14,79,12,"data"],[76,18,79,16],[76,19,79,17,"user"],[76,23,79,21],[76,24,79,22],[77,4,80,2],[77,5,80,3],[78,4,82,2],[78,10,82,8,"register"],[78,18,82,16],[78,21,82,19],[78,27,82,19,"register"],[78,28,82,26,"name"],[78,32,82,38],[78,34,82,40,"email"],[78,39,82,53],[78,41,82,55,"password"],[78,49,82,71],[78,54,82,76],[79,6,83,4],[79,12,83,10,"data"],[79,16,83,14],[79,19,83,17],[79,25,83,23,"api"],[79,34,83,26],[79,35,83,26,"api"],[79,38,83,26],[79,39,83,27,"post"],[79,43,83,31],[79,44,83,32],[79,60,83,48],[79,62,83,50],[80,8,83,52,"email"],[80,13,83,57],[81,8,83,59,"password"],[81,16,83,67],[82,8,83,69,"name"],[83,6,83,74],[83,7,83,75],[83,8,83,76],[84,6,84,4],[84,12,84,10,"storeToken"],[84,22,84,20],[84,23,84,21,"data"],[84,27,84,25],[84,28,84,26,"token"],[84,33,84,31],[84,34,84,32],[85,6,85,4,"setUser"],[85,13,85,11],[85,14,85,12,"data"],[85,18,85,16],[85,19,85,17,"user"],[85,23,85,21],[85,24,85,22],[86,4,86,2],[86,5,86,3],[88,4,88,2],[89,4,89,2],[89,10,89,8,"loginWithGoogle"],[89,25,89,23],[89,28,89,26,"loginWithGoogle"],[89,29,89,26],[89,34,89,32],[90,6,90,4],[90,10,90,8,"Platform"],[90,18,90,16],[90,19,90,16,"default"],[90,26,90,16],[90,27,90,17,"OS"],[90,29,90,19],[90,34,90,24],[90,39,90,29],[90,48,90,62],[90,50,90,64],[91,8,91,6],[91,14,91,12,"redirectUrl"],[91,25,91,23],[91,28,91,26,"window"],[91,34,91,32],[91,35,91,33,"location"],[91,43,91,41],[91,44,91,42,"origin"],[91,50,91,48],[91,53,91,51],[91,72,91,70],[92,8,92,6,"window"],[92,14,92,12],[92,15,92,13,"location"],[92,23,92,21],[92,24,92,22,"href"],[92,28,92,26],[92,31,92,29],[92,75,92,73,"encodeURIComponent"],[92,93,92,91],[92,94,92,92,"redirectUrl"],[92,105,92,103],[92,106,92,104],[92,108,92,106],[93,6,93,4],[94,4,94,2],[94,5,94,3],[95,4,96,2],[95,10,96,8,"handleGoogleCallback"],[95,30,96,28],[95,33,96,31],[95,39,96,38,"sessionId"],[95,48,96,55],[95,52,96,60],[96,6,97,4],[96,12,97,10,"data"],[96,16,97,14],[96,19,97,17],[96,25,97,23,"api"],[96,34,97,26],[96,35,97,26,"api"],[96,38,97,26],[96,39,97,27,"post"],[96,43,97,31],[96,44,97,32],[96,66,97,54],[96,68,97,56],[97,8,97,58,"session_id"],[97,18,97,68],[97,20,97,70,"sessionId"],[98,6,97,80],[98,7,97,81],[98,8,97,82],[99,6,98,4],[99,12,98,10,"storeToken"],[99,22,98,20],[99,23,98,21,"data"],[99,27,98,25],[99,28,98,26,"token"],[99,33,98,31],[99,34,98,32],[100,6,99,4,"setUser"],[100,13,99,11],[100,14,99,12,"data"],[100,18,99,16],[100,19,99,17,"user"],[100,23,99,21],[100,24,99,22],[101,4,100,2],[101,5,100,3],[102,4,102,2],[102,10,102,8,"logout"],[102,16,102,14],[102,19,102,17],[102,25,102,17,"logout"],[102,26,102,17],[102,31,102,29],[103,6,103,4],[103,10,103,8],[104,8,104,6],[104,14,104,12,"api"],[104,23,104,15],[104,24,104,15,"api"],[104,27,104,15],[104,28,104,16,"post"],[104,32,104,20],[104,33,104,21],[104,47,104,35],[104,48,104,36],[105,6,105,4],[105,7,105,5],[105,8,105,6],[105,14,105,12],[105,15,105,14],[106,6,106,4],[106,12,106,10,"clearToken"],[106,22,106,20],[106,23,106,21],[106,24,106,22],[107,6,107,4,"setUser"],[107,13,107,11],[107,14,107,12],[107,18,107,16],[107,19,107,17],[108,4,108,2],[108,5,108,3],[109,4,110,2],[109,10,110,8,"updateUser"],[109,20,110,18],[109,23,110,22,"u"],[109,24,110,29],[109,28,110,34,"setUser"],[109,35,110,41],[109,36,110,42,"u"],[109,37,110,43],[109,38,110,44],[110,4,112,2],[110,24,113,4],[110,28,113,4,"_reactJsxDevRuntime"],[110,47,113,4],[110,48,113,4,"jsxDEV"],[110,54,113,4],[110,56,113,5,"AuthContext"],[110,67,113,16],[110,68,113,17,"Provider"],[110,76,113,25],[111,6,113,26,"value"],[111,11,113,31],[111,13,113,33],[112,8,113,35,"user"],[112,12,113,39],[113,8,113,41,"token"],[113,13,113,46],[114,8,113,48,"isLoading"],[114,17,113,57],[115,8,113,59,"login"],[115,13,113,64],[116,8,113,66,"register"],[116,16,113,74],[117,8,113,76,"loginWithGoogle"],[117,23,113,91],[118,8,113,93,"handleGoogleCallback"],[118,28,113,113],[119,8,113,115,"logout"],[119,14,113,121],[120,8,113,123,"updateUser"],[121,6,113,134],[121,7,113,136],[122,6,113,136,"children"],[122,14,113,136],[122,16,114,7,"children"],[123,4,114,15],[124,6,114,15,"fileName"],[124,14,114,15],[124,16,114,15,"_jsxFileName"],[124,28,114,15],[125,6,114,15,"lineNumber"],[125,16,114,15],[126,6,114,15,"columnNumber"],[126,18,114,15],[127,4,114,15],[127,11,115,26],[127,12,115,27],[128,2,117,0],[129,0,117,1],[129,3]],"functionMap":{"names":["<global>","useAuth","AuthProvider","storeToken","clearToken","checkAuth","useEffect$argument_0","login","register","loginWithGoogle","handleGoogleCallback","logout","updateUser"],"mappings":"AAA;uBC4B,6BD;OEE;qBCK;GDI;qBEE;GFI;gCGE;GHsB;YIE;GJE;gBKE;GLI;mBME;GNI;0BOG;GPK;+BQE;GRI;iBSE;GTM;qBUE,uBV;CFO"},"hasCjsExports":false},"type":"js/module"}]}